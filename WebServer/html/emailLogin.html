<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title></title>
    <style media="screen">
      #divClock{
        font-size: 12px;
        color: rgb(255, 255, 255);
      }
      body {
        background: #131722!important;
        color: #fff!important;
      }
      body > .grid {
        height: 100%;
      }
      .image {
        margin-top: -100px;
      }
      .column {
        max-width: 450px;
      }
      .colorWhite {
        color : white!important;
      }
      .ui.blue.button {
        background-color: #0061ff!important;
        color: #FFFFFF;
        text-shadow: none;
        background-image: none;
      }
    </style>
    <link rel="stylesheet" type="text/css" href="asset/css/semantic.css">
    <script
      src="https://code.jquery.com/jquery-3.1.1.min.js"
      integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
      crossorigin="anonymous"></script>
    <script src="asset/js/semantic.js"></script>
    <script type="text/javascript">


      window.addEventListener('DOMContentLoaded', function()
      {
        //-------------------------------------------------------;
        //-------------------------------------------------------;
        //-------------------------------------------------------;
        //REGEX;
        //-------------------------------------------------------;
        //-------------------------------------------------------;
        //-------------------------------------------------------;

        //-------------------------------------------------------;
        //-------------------------------------------------------;
        //-------------------------------------------------------;
        //DOM element;
        //-------------------------------------------------------;
        //-------------------------------------------------------;
        //-------------------------------------------------------;

        window.el = {};
        window.el.input = {};
        window.el.input.email = window.document.getElementById("inputEmail");
        window.el.input.password = window.document.getElementById("inputPassword");

        window.el.btn = {}
        window.el.btn.login = window.document.getElementById("btnLogin");
        window.el.btn.join = window.document.getElementById("btnJoin");


        //-------------------------------------------------------;
        //-------------------------------------------------------;
        //-------------------------------------------------------;
        //Functions;
        //-------------------------------------------------------;
        //-------------------------------------------------------;
        //-------------------------------------------------------;

        var webStorageSetItem = function( o ){
          debugger;
          var s,so;
          for( s in o ){
            so = o[ s ];
            console.log( s );
            window.localStorage.setItem( s , so );
          }
        }

    	/* 
    	[ìš”ì•½ ì„¤ëª…]
    	1. XMLHttpRequest : ë¹„ë™ê¸°ì‹ í†µì‹  ë°©ì‹ ê°ì²´ì´ë©°, ì„œë²„ì™€ ë°ì´í„°ë¥¼ êµí™˜í•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤
    	2. xhr.open : ì„œë²„ë¡œ ë³´ë‚¼ Ajax ìš”ì²­ì˜ í˜•ì‹ì„ ì„¤ì •í•©ë‹ˆë‹¤
    	3. xhr.send : Ajax ìš”ì²­ì„ ì„œë²„ë¡œ ì „ë‹¬í•©ë‹ˆë‹¤
    	
    	4. xhr.onreadystatechange : XMLHttpRequest ê°ì²´ì˜ í˜„ì¬ ìƒíƒœë¥¼ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤    	
    	5. readyState í”„ë¡œí¼í‹° : 
    		- UNSENT (ìˆ«ì 0) : XMLHttpRequest ê°ì²´ê°€ ìƒì„±ë¨
    		- OPENED (ìˆ«ì 1) : open() ë©”ì†Œë“œê°€ ì„±ê³µì ìœ¼ë¡œ ì‹¤í–‰ë¨
    		- HEADERS_RECEIVED (ìˆ«ì 2) : ëª¨ë“  ìš”ì²­ì— ëŒ€í•œ ì‘ë‹µì´ ë„ì°©í•¨
    		- LOADING (ìˆ«ì 3) : ìš”ì²­í•œ ë°ì´í„°ë¥¼ ì²˜ë¦¬ ì¤‘
    		- DONE (ìˆ«ì 4) : ìš”ì²­í•œ ë°ì´í„°ì˜ ì²˜ë¦¬ê°€ ì™„ë£Œë˜ì–´ ì‘ë‹µí•  ì¤€ë¹„ê°€ ì™„ë£Œë¨
    		
    	6. xhr.status : ì„œë²„ë¡œë¶€í„° ì‘ë‹µë°›ì€ ìƒíƒœ ë° ë¦¬í„´ ë©”ì‹œì§€ë¥¼ í™•ì¸í•©ë‹ˆë‹¤
    	7. status í”„ë¡œí¼í‹° :
    		- 200 ~ 201 : ìš”ì²­ì´ ì„±ê³µì  ìƒíƒœ
    		- ê·¸ì™¸ ìƒíƒœ : ì¸í„°ë„·ì—ì„œ http ì‘ë‹µ ìƒíƒœë¥¼ ê²€ìƒ‰í•´ì„œ í™•ì¸
    	*/

    	
    	
    	/* ì´ë²¤íŠ¸ í•¨ìˆ˜ ì •ì˜ */
    	function requestGet(){
    		console.log("");
    		console.log("[requestGet] : [start]");    		
    		console.log("");
    		
    		// url ë° ì „ì†¡ ë°ì´í„° ì„ ì–¸
    		var url = "http://jsonplaceholder.typicode.com/posts?userId=1&id=1";
    		    		    		    		
    		// XMLHttpRequest ê°ì²´ ìƒì„± ë° ìš”ì²­ ìˆ˜í–‰
    		var xhr = new XMLHttpRequest();
    		xhr.open("GET", url, true);
    		    		
    		console.log("[request url] : " + url);    		    	
    		console.log("[request method] : " + "GET");
    		console.log("");
    		
    		//xhr.onreadystatechange = CallbackFunction; //ì½œë°± í•¨ìˆ˜ ì§€ì •í•´ì„œ ì²˜ë¦¬ ê°€ëŠ¥    		
    		xhr.onreadystatechange = function() {
    			if (xhr.readyState == 4) { 
    				if (xhr.status == 200 || xhr.status == 201){
    					console.log("[status] : " + xhr.status);
    					console.log("[response] : " + "[success]");    				   				    				
    					console.log("[response] : " + xhr.responseText);
    					console.log("");        				
    				}
    				else {
    					console.log("[status] : " + xhr.status);
    					console.log("[response] : " + "[fail]");    				   				    				
    					console.log("[response] : " + xhr.responseText);
    					console.log("");        				
    				}					
    			}    			
    		}
    		xhr.send(null); //get ì¿¼ë¦¬ íŒŒëŒ ë°©ì‹ì¼ë•Œ null    					    		    		
									
    	};

    	
    	
    	/* ì´ë²¤íŠ¸ í•¨ìˆ˜ ì •ì˜ */
    	function requestPost(){
    		console.log("");
    		console.log("[requestPost] : [start]");    		
    		console.log("");
    		
    		// url ë° ì „ì†¡ ë°ì´í„° ì„ ì–¸
    		var url = "http://jsonplaceholder.typicode.com/posts?userId=1&id=1";
    		    		    		    		
    		// XMLHttpRequest ê°ì²´ ìƒì„± ë° ìš”ì²­ ìˆ˜í–‰
    		var xhr = new XMLHttpRequest();
    		xhr.open("POST", url, true);
    		    		
    		console.log("[request url] : " + url);    		    	
    		console.log("[request method] : " + "POST");
    		console.log("");
    		
    		//xhr.onreadystatechange = CallbackFunction; //ì½œë°± í•¨ìˆ˜ ì§€ì •í•´ì„œ ì²˜ë¦¬ ê°€ëŠ¥    		
    		xhr.onreadystatechange = function() {
    			if (xhr.readyState == 4) {
    				if (xhr.status == 200 || xhr.status == 201){
    					console.log("[status] : " + xhr.status);
    					console.log("[response] : " + "[success]");    				   				    				
    					console.log("[response] : " + xhr.responseText);
    					console.log("");        				
    				}
    				else {
    					console.log("[status] : " + xhr.status);
    					console.log("[response] : " + "[fail]");    				   				    				
    					console.log("[response] : " + xhr.responseText);
    					console.log("");        				
    				}    				
    			}    			
    		}
    		xhr.send(null); //post ì¿¼ë¦¬ íŒŒëŒ ë°©ì‹ì¼ë•Œ null    					    		    		
									
    	};

    	
    	
    	/* ì´ë²¤íŠ¸ í•¨ìˆ˜ ì •ì˜ */
    	function requestPostBodyJson( url, data, cbFunction ){
    		console.log("");
    		console.log("[requestPostBodyJson] : [start]");    		
    		console.log("");
    		
    		// url ë° ì „ì†¡ ë°ì´í„° ì„ ì–¸
    		//var url = "http://jsonplaceholder.typicode.com/posts";
    		
    		// ì „ì†¡ json ë°ì´í„° ì„ ì–¸
    		var jsonData = data//{"userId" : 1 , "id" : 1};
    		    		    		    		debugger;
    		// XMLHttpRequest ê°ì²´ ìƒì„± ë° ìš”ì²­ ìˆ˜í–‰
    		var xhr = new XMLHttpRequest();
    		xhr.open("POST", url, true);
    		    		
    		console.log("[request url] : " + url);
    		console.log("[request data] : " + JSON.stringify(jsonData));
    		console.log("[request method] : " + "POST");
    		console.log("");
    		
    		//xhr.onreadystatechange = CallbackFunction; //ì½œë°± í•¨ìˆ˜ ì§€ì •í•´ì„œ ì²˜ë¦¬ ê°€ëŠ¥    		
    		xhr.onreadystatechange = function() {
    			if (xhr.readyState == 4) {
    				if (xhr.status == 200 || xhr.status == 201){
    					console.log("[status] : " + xhr.status);
    					console.log("[response] : " + "[success]");    				   				    				
    					console.log("[response] : " + xhr.responseText);
    					console.log("");
              cbFunction( xhr.responseText )        				
    				}
    				else {
    					console.log("[status] : " + xhr.status);
    					console.log("[response] : " + "[fail]");    				   				    				
    					console.log("[response] : " + xhr.responseText);
    					console.log("");        				 
    				}						    				
    			}    			
    		}
    		xhr.setRequestHeader("Content-Type", "application/json");    		
    		xhr.send(JSON.stringify(jsonData)); //post body json ë°©ì‹ ì¼ë•Œ    					    		    		
									
    	};

        function showClock(){
          var currentDate = new Date();
          var divClock = document.getElementById('divClock');
          var msg = "í˜„ì¬ ì‹œê°„ : ";
          if(currentDate.getHours()>12){      //ì‹œê°„ì´ 12ë³´ë‹¤ í¬ë‹¤ë©´ ì˜¤í›„ ì•„ë‹ˆë©´ ì˜¤ì „
            msg += "ì˜¤í›„ ";
            msg += currentDate.getHours()-12+"ì‹œ ";
        }
        else {
          msg += "ì˜¤ì „ ";
          msg += currentDate.getHours()+"ì‹œ ";
        }
  
          msg += currentDate.getMinutes()+"ë¶„ ";
          msg += currentDate.getSeconds()+"ì´ˆ";
  
          divClock.innerText = msg;
  
          if (currentDate.getMinutes()>58) {    //ì •ê° 1ë¶„ì „ë¶€í„° ë¹¨ê°•ìƒ‰ìœ¼ë¡œ ì¶œë ¥
            divClock.style.color="red";
          }
          setTimeout(showClock,1000);  //1ì´ˆë§ˆë‹¤ ê°±ì‹ 
        }
        
        showClock();

        var checkEmail = function(str){
          let regex = new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)          
          console.log(regex.test(str));

          return regex.test(str)
          
        }
        //-------------------------------------------------------;
        //-------------------------------------------------------;
        //-------------------------------------------------------;
        //Event;
        //-------------------------------------------------------;
        //-------------------------------------------------------;
        //-------------------------------------------------------;

        window.evt = {}
        window.evt.btnLoginClick = window.el.btn.login.addEventListener("click",function(evt){
          //debugger;
          var email = window.el.input.email.value;
          var password = window.el.input.password.value;

          console.log( "email : ", email );
          console.log( "password : ", password );

          if( email == "" ){
            return alert("ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”")
          }
          else
          {
            if( !checkEmail( email ) ){
              return alert("ì´ë©”ì¼í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤.")
            }
          }

          if( password == "" ){
            return alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”")
          }
          console.log( "window.el.btn.login - click!" );

          // var xhr = new XMLHttpRequest();
          //   xhr.open("GET" , `/api/login`, {redirect: "follow",});
          //   xhr.onreadystatechange = function(){
              
          //     if( xhr.readyState == 4 && xhr.status == 200)
          //     {
          //       var d =  xhr.responseText
          //       debugger;
          //       console.log(d)
          //       location.href="/"
          //     }
          //   }

          //   xhr.send();
            requestPostBodyJson('/api/login', { a:1,b:2}, function( d ){
              console.log( "===========" )
              console.log( "===========" )
              console.log( "===========" )
              console.log( "===========" )
              var _d = JSON.parse( d );
              webStorageSetItem( JSON.parse( _d.d ) )
              location.href="/"

            })
           


    

          return 

        })        
        window.evt.btnJoinClick = window.el.btn.join.addEventListener("click",function(evt){
          console.log( "window.el.btn.join - click!" )
          window.location.href = "/html/join.html"
        })      
      });
      
    </script>
  </head>
  <body>
    
    <div class="ui middle aligned center aligned grid">
      <div class="column">
        <h2 class="ui image header">
          <div class="content">
            <!-- <div>ğŸ”‘</div> -->
            <div class="colorWhite">ì´ë©”ì¼ë¡œ ë¡œê·¸ì¸</div>
            <div id="divClock" class="clock"></div>
          </div>
        </h2>
        <form class="ui large form">
         
            <div class="field">
              <div class="ui input">
                <input id="inputEmail" type="text" name="email" placeholder="ì´ë©”ì¼">
              </div>
            </div>
            <div class="field">
              <div class="ui input">
                <input id="inputPassword" type="password" name="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
              </div>
            </div>
            <div id="btnLogin" class="ui fluid large blue submit button">ë¡œê·¸ì¸</div>
    
    
          <div class="ui error message"></div>
    
        </form>
        <div style="font-size: 0.8rem;margin-top: 15px;">
          íšŒì›ê°€ì…ì‹œ ë“±ë¡í•œ ì´ë©”ì¼ë¡œ ë¡œê·¸ì¸í•©ë‹ˆë‹¤.
        </div>
        <div id="btnJoin" class="ui message">
          ì–´ì¹´ìš´íŠ¸ê°€ ì—†ë‚˜ìš”? <a href="#">Sign Up</a>
        </div>

      </div>
    </div>
  </body>
</html>
